<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Druid FTW!</title>

		<meta name="description" content="A framework for easily creating beautiful presentations using HTML">
		<meta name="author" content="Hakim El Hattab">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.min.css">
		<link rel="stylesheet" href="css/theme/moon.css" id="theme">
		<link rel="stylesheet" href="css/skills.css">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- If the query includes 'print-pdf', include the PDF print sheet -->
		<script>
			if( window.location.search.match( /print-pdf/gi ) ) {
				var link = document.createElement( 'link' );
				link.rel = 'stylesheet';
				link.type = 'text/css';
				link.href = 'css/print/pdf.css';
				document.getElementsByTagName( 'head' )[0].appendChild( link );
			}
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
        <section>
          <h1>Drupal 8 Theming</h1>
          <h5>24.9.2014 Lauri Eskola</h5>
        </section>
        <section>
          <section>
            <h4>Me:</h4>
            <h2>@lauriii</h2>
            <h3>(Lauri Eskola)</h3>
          </section>
          <section class="twitter">
            <img src="img/twitter.png" width="100px"><h2>@laurii1</h2>
          </section>
          <section>
            <img src="img/lauri.jpg">
          </section>
        </section>
        <section>
          <section>
            <h2>What's new?</h2>
          </section>
          <section>
            <h2>HTML5</h2>
            <img src="http://openacademy.github.io/HTML5-open-academy/session07-css3/images/css3_logo.png">
          </section>
          <section>
            <h2>HTML5</h2>
            <pre>
              <code>
      <header role="banner">
        <h1>Dries FTW!</h1>
        <nav>
          <a href="/">home</a> | <a href="/info">info</a>
        </nav>
      </header>
      <main>
        <aside>
          ...
        </aside>
        <div>
          ... 
        </div>    
      </main>
      <footer role="">
      </footer>
              </code>
            </pre>
          </section>
          <section>
            <h2>So Drupal 8 WON'T support</h2>
            <h2 class="fragment slide-in">ie 6</h2>
            <h2 class="fragment slide-in">ie 7</h2>
            <h2 class="fragment slide-in">ie 8</h2>
          </section>
          <section data-background="http://www.reactiongifs.us/wp-content/uploads/2013/06/cheering_minions.gif">
          </section>
          <section>
            <h2>Drupal CSS</h2>
            <h3>Drupal 7</h3>
            <pre>
              <code class="coffeescript">
      &lt;body class="html drupal7 is-awesome wtf not-logged-in no-sidebars page-node page-node- page-node-274 node-type-page">
              </code>
            </pre>
            <h3>Drupal 8</h3>
            <pre>
              <code>
      &lt;body&gt;
              </code>
            </pre>
          </section>
          <section>
            <h2>CSS build on SMACSS and BEM</h2>
            <h5><a href="https://www.drupal.org/node/1887918">More from #1887918</a></h5>
            <h3>CSS</h3>
            <pre>
              <code>
      .field {
        margin: 6px 9px;
      }
      .field.field--name {
        color: pink; 
      }
              </code>
            </pre>
            <h3>HTML</h3>
            <pre>
              <code class="xml">
      &lt;div class="field field--name" /&gt;
              </code>
            </pre>
          </section>
          <section>
            <h2>Seven CSS file structure</h2>
            <img src="img/seven_css_structure.png">
          </section>
          <section>
            <h3>Removing CSS files</h3>
            <video controls data-autoplay>
              <source src="videos/remove-css.mp4" type="video/mp4">
            </video>
          </section>
        </section>
        <section>
          <section>
            <h2>Drupal 8 File structure</h3>
          </section>
          <section>
            <h2>No more</h2>
            <h3>sites/all/where/the/f*ck/is/my/themes</h3>
          </section>
          <section>
            <img src="img/file_structure.png">
          </section>
          <section>
            Templates in template folder!
            <img src="img/file_structure2.png">
          </section>
          <section>
            <h1>AND!</h1>
          </section>
          <section>
            <a href="https://www.drupal.org/node/2226207">
              <h2>Templates are auto-loaded with hook_theme implementation key!</h2>
            </a>
          </section>
        </section>
        <section>
          <section>
            <h2>Completely new theme layer!</h2>
          </section>
          <section>
            <h3>Drupal 7 theme layer - WTF?</h3>
            <img src="img/theme_layer_d7.png" height="500px">
          </section>
          <section>
            <h3>Drupal 8 theme layer - FTW!</h3>
            <img src="img/theme_layer_d8.png" height="400px">
          </section>
        </section>
        <section>
          <section data-background="http://www.chewy.com/c/sites/default/files/imce/images/article/Happy-smiling-cat-portrait.jpg">
            <h1>Twig</h1>
          </section>
          <section>
            <h2>Basics in under 5 minutes</h2>
            <h3>This is Twig, no Drupal!</h3>
          </section>
          <section>
            <h2>Comments & Vars</h2>
            <h3>PHP:</h3>
            <pre>
              <code>
      &lt;?php

      // My test variable
      print $variable;
              </code>
            </pre>
            <h3>Twig:</h3>
            <pre>
              <code>
      {# My test variable #}
      {{ variable }}
              </code>
            </pre>
          </section>
          <section>
            <h2>Set variables</h2>
            <pre>
              <code>
      {% set variable = 'result' %}
              </code>
            </pre>
            <pre>
            <code>
      {%
        set array = [
          'foo',
          'bar',
        ]
      %}
              </code>
            </pre>
          </section>
          <section>
            <h2>Arrays</h2>
            <h3>PHP:</h3>
            <pre>
              <code>
      &lt;?php

      // WTF?!
      print $foo['im']['und']->boss['long']['ass']['shit'] ?>
              </code>
            </pre>
            <h3>Twig:</h3>
            <pre>
              <code>
      {{ foo.im.boss.long.ass.mofo }}
              </code>
            </pre>
          </section>
          <section>
            <h2>Loops</h2>
            <pre>
              <code>
      <h2>Team Awesome</h2>
      <ul>
        {% for user in users %}
          <li>{{ user.username}}</li>
        {% endfor %}
      </ul>
              </code>
            </pre>
            <pre>
              <code>
        <h2>Team Awesome</h2>
        <ul>
          <li>cottser</li>        
          <li>joel</li>
          <li>david</li>
          <li>mark carver</li>        
          <li>mortendk</li>
        </ul>
              </code>
            </pre>
          </section>
          <section>
            <h2>Loop stuff</h2>
            <pre>
              <code>
      {{ loop.length }}    

      {{ loop.first }}

      {{ loop.last }}
     
      {{ loop.index }}

      {% if loop.first %}
        ...  
      {% elseif loop.index == 2 %}
        ...
      {% elseif loop.last %}
          ...
      {% endif %}
              </code>
            </pre>
          </section>
         <section>
            <h2>Loop with empty text</h2>
            <pre>
              <code>
      <h2>Team Awesome</h2>
      <ul>
        {% for user in users %}
          <li>{{ user.username}}</li>
        {% else %}
          <li>no results found</li>
        {% endfor %}
      </ul>
              </code>
            </pre>
          </section>
          <section>
            <h2>Filter</h2>
            <pre>
              <code>
      <p>
        {% filter upper %}
          uppercase for the win
        {% endfilter %}
      </p>
              </code>
            </pre>
          </section>
          <section>
            <h2>|Filter</h2>
            <pre>
              <code>
      {% set name = 'Lauri' %}
      <span>           
        {{ name|length }}
      </span>
              </code>
            </pre>
            <h3>Returns:</h3>
            <pre>
              <code>
      <span>
        5
      </span>
              </code>
            </pre>
          </section>
          <section class="huge-list">
            <ul>
              <li>|abs</li>
              <li>|batch</li>
              <li>|capitalize</li>
              <li>|covert_encoding</li>
              <li>|date</li>
              <li>|date_modify</li>
              <li>|default</li>
              <li>|escape</li>
              <li>|first</li>
              <li>|format</li>
            </ul>
            <ul>
              <li>|join</li>
              <li>|json_encode</li>
              <li>|keys</li>
              <li>|last</li>
              <li>|length</li>
              <li>|lower</li>
              <li>|nl2br</li>
              <li>|number_format</li>
              <li>|merge</li>
              <li>|upper</li>
            </ul>
            <ul>
              <li>|raw</li>
              <li>|replace</li>
              <li>|reverse</li>
              <li>|round</li>
              <li>|slice</li>
              <li>|sort</li>
              <li>|split</li>
              <li>|striptags</li>
              <li>|title</li>
              <li>|trim</li>
            </ul>
            <ul>
              <li>|url_encode</li> 
            </ul>
          </section>
          <section>
            <h2>Twig blocks</h2>
            page.html.twig
            <pre>
              <code>
      {% block headerblock %}
        <h2>This block needs more kittens!</h2>
      {% endblock %}
              </code>
            </pre>
            page--front.html.twig
            <pre>
              <code>
      {% extends "page.html.twig" %}
      {% block headerblock %}
        {{ parent() }}
        <h4>Kitten!</h4>
      {% endblock %}
              </code>
            </pre>
          </section>
          <section>
            <video controls data-autoplay>
              <source src="videos/twig-blocks.mp4" type="video/mp4">
            </video>
          </section>
          <section>
            <h2>More stuff?</h2>
            <h3><a href="http://twig.sensiolabs.org/">Twig documentation: http://twig.sensiolabs.org/</a></h3>
          </section>
          <section data-background="http://critterbabies.com/wp-content/gallery/kittens/cute-kitten-playing.jpg">
            <h2>You no like it?</h2>
          </section>
          <section data-background="img/there-i-fixed-it.jpg">
            <h2>Solution!</h2>
            <pre>
              <code>
      # engine: phptemplate
              </code>
            </pre>
            themename.info
          </section>
        </section>
        <section>
          <section>
            <h2>Drupal specific Twig functionalities</h2>
            <h4>This is Drupal!</h4>
          </section>
          <section>
            <h2>Filters</h2>
            <pre>
              <code>
      {% set class_name = 'lauri/druid' %}

      {%
        set contributors = [
          'rteijeiro',
          'joelpittet',
          'Cottser',
          'lauriii',
          'Dries',
        ]
      %}

      {{ class_name|clean_class }}
      {{ contributors|without('lauriii') }},
              </code>
            </pre>
            <h3>Returns</h3>
            <pre>
              <code>
      lauri-druid
      rteijeiro,joelpittet,Cottser,Dries,
          </section>
              </code>
            </pre>
          <section>
            <h2>HTML Attributes</h2>
            <h4><a href="https://www.drupal.org/node/2325517">Not ready yet, more info #2325517</a></h4>
            <h4>Preprocess:</h4>
            <pre>
              <code>
      &lt;?php
        function template_preprocess_username(&$variables) {
          $variables['attributes'] = new Attribute();
        }
      ?&gt;
              </code>
            </pre>
            <h4>Template:</h4>
            <pre>
              <code class="xml">
      &lt;div{{ attributes.setAttribute('id', 'kitten').setAttribute('I-Love', 'Dries') }}&gt;

      &lt;div{{ attributes.removeAttribute('id') }}&gt;
              </code>
            </pre>
          </section>
          <section>
            <h2>Add/Remove class</h2>  
            <h4><a href="https://www.drupal.org/node/2325067">More information #2325067</a></h4>
            <pre>
              <code class="xml">
      &lt;div{{ attributes.addClass('field-item-' ~ name|clean_class) }}&gt;
              </code>
            </pre>
            OR
            <pre>
              <code class="xml">
      &lt;div{{ attributes.removeClass('GTFO', 'i-hate--you') }}&gt;
              </code>
            </pre>
          </section>
          <section>
            <h2>Translate</h2>  
            <pre>
              <code>
      {{ 'Author: @username'| t({'@username':username}) }}
              </code>
            </pre>
            <h4>Or:</h4>
            <pre>
              <code>
      {% trans %}
        Author {{ username }}
      {% endtrans %}
              </code>
            </pre>
          </section>
          <section data-background="http://i2.kym-cdn.com/entries/icons/original/000/009/993/tumblr_m0wb2xz9Yh1r08e3p.jpg">
            <h2>Twig debug</h2>
            <h4>No more guessing!</h4>
          </section>
          <section>
            <pre>
              <code>
    <!-- THEME DEBUG -->
    <!-- CALL: _theme('page') -->
    <!-- FILE NAME SUGGESTIONS:
       * page--front.html.twig
       * page--node.html.twig
       x page.html.twig
    -->
    <!-- BEGIN OUTPUT from 'core/themes/bartik/templates/page.html.twig' -->
              </code>
            </pre>
          </section>
          <section>
            <video controls data-autoplay>
              <source src="videos/debug.mp4" type="video/mp4">
            </video>
          </section>
          <section>
            <h2>Want this to D7?</h2>
          </section>
          <section>
            <h2><a href="https://www.drupal.org/node/2307505">Do it! #2307505</a></h2>
          </section>
        </section>
        <section>
          <section data-background="img/cleaning.jpeg">
            <h2>Deep template clean up</h2>
          </section>
          <section>
            <h2>We've made even @mortendk rock while theming</h2>
          </section>
          <section>
            <h5>pager.html.twig</h5>
            <video controls>
              <source src="videos/pager.mp4" type="video/mp4">
            </video>
          </section>
          <section>
            <h5>menu.html.twig</h5>
            <video controls>
              <source src="videos/menu.mp4" type="video/mp4">
            </video>
          </section>
        </section>
        <section>
          <section>
            <h2>Autoescape</h2>
          </section>
          <section>
            <img src="img/autoescape_all.jpg" width="800px" >
          </section>
          <section>
            <h2>Context-Aware Auto-Escaping</h2>
            <p>Basic idea: everytime variable goes to template run appropriate escaping function! </p>
          </section>
          <section>
            <h2>Different Escape functions</h2>
            <pre>
              <code>
      &lt;?php

      Drupal\Component\Utility\SafeMarkup::isSafe();
      Drupal\Component\Utility\SafeMarkup::escape();
      Drupal\Component\Utility\SafeMarkup::checkAdminXss();

              </code>
            </pre>
          </section>
          <section>
            <h2>How it works?</h2>
            <pre>
              <code>
    &lt;?php

    public static function escape($string) {
      return static::isSafe($string) ? $string : String::checkPlain($string);
    }
                
              </code>
            </pre>
          </section>
        </section>
        <section>
          <section data-background="https://pbs.twimg.com/media/BpioEelIEAIcJOT.jpg:large">
            <h1>Consensus banana</h1>
          </section>
          <section>
            <h2>Steps:</h2>
            <ul>
              <li>Phase 1. Move all the classes to templates <span class="fragment yes"> &#x2713; done!</li>
              <li>Phase 2. Classy<span class="fragment yes"> <- we are here!</span></li>
            </ul>
          </section>
          <section>
            <h4>Phase 1:</h4>
            <h2>Move classes from preprocess to templates</h2>
          </section>
          <section>
            <h4>node.html.twig</h4>
            <pre>
              <code class="xml" contenteditable>
  {%
    set classes = [
      'node',
      'node--type-' ~ node.bundle|clean_class,
      node.isPromoted() ? 'node--promoted',
      node.isSticky() ? 'node--sticky',
      not node.isPublished() ? 'node--unpublished',
      view_mode ? 'node--view-mode-' ~ view_mode|clean_class,
      'clearfix',
    ]
  %}
  &lt;article{{ attributes.addClass(classes) }}>
   {{ content }}
  &lt;/article>

              </code>
            </pre>
          </section>
          <section data-background="http://www.stitchfashion.com/wp-content/uploads/2014/04/kviqq.png">
            <h4>Phase 2:</h4>
            <h2>New theme: Classy<h2>
          </section>
          <section>
            <h2>What will this change?</h2>
            <h3 class="fragment slide-in">Move all the class logic to Classy - so no classes from core <small>(even automated tests uses now Classy)</small></h3>
            <h3 class="fragment slide-in">Simplify core markup even more! <small>(removing all unnecessary divs & other elements)</small></h3>
          </section>
          <section>
            <h2>Creating new theme?</h2>
            <h3>Remember to extend Classy!</h3>
          </section>
        </section>
        <section>
          <section data-background="img/kitten.jpg">
            <h2>Bonus!</h2>
          </section>
          <section>
            <h2>No more hardcoded logo..</h2>
            <img src="img/logo_block.png">
          </section>
          <section>
            <h2>... or menu!</h2>
            <img src="img/menu_as_block.png">
          </section>
        </section>
        <section>
          <section>
            <h2>Want to help?</h2>
            <h3 class="fragment">RC1 means markup freeze...</h3>
            <h3 class="fragment">... so there's plenty of time still!</h3>
          </section>
          <section>
            <h1>Questions?</h1>
          </section>
        </section>
      </div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.min.js"></script>

		<script>

			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
        width: 1024, //900
        height: 768, //700
				controls: true,
				progress: true,
				history: true,
				center: true,
        loop: true,

				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none
        backgroundTransition: 'concave', // default/none/slide/concave/convex/zoom

				// Parallax scrolling
				// parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
				// parallaxBackgroundSize: '2100px 900px',
        parallaxBackgroundImage: '', // e.g. "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'"

        // Parallax background size
        parallaxBackgroundSize: '', // CSS syntax, e.g. "2100px 900px"

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
				]
			});

		</script>

	</body>
</html>
